language: php

php:
  - 5.3
  - 5.4
  - 5.5
  - 5.6
  
env:
 - Foo=test
 - secure: TpvD0s4u+b1zRk17kWvABgJa83GCkMSFPVrrinpPlPekw0zS7yaCvDLLnNrJ7BuVtCFTLhLbeNKj8S3ub+T9WrF0Fpk78rtImI8RVA6ipfzdYgbUUswVfmkZBgS28PF88PHq64Z62Q2NqTMNYlVBURKnnG9KXik2blgdtnoaLH+dkgX9DQsmvJmiRngRto3qTlKQsPpJAe0jx9Y2r28tY4frG0j9oHrf9QHRu6bTw4vcfLDoWJ6UqoQIWCW7wZFHVWmQrX5dBT0J1fGF60W3RsKpuS91DUg6l6fA/fP5+z1K0+75y7HD2XeXpKnuNe5cNIMReh9wrGCboF36Mbp6FA==
 
matrix:
  allow_failures:
    - php: "5.3"
  exclude:
    - php: "5.4"
  include:
    - php: "5.6"
      env: php=123test

addons:
  hosts:
    local.symfony2-standard-template: 127.0.0.1

before_install:
  - sudo apt-get update
  - sudo apt-get install apache2
  - sudo cp config/src.vhost.conf /etc/apache2/sites-available
  - sudo a2ensite src.vhost.conf
  - sudo a2enmod rewrite
  - sudo a2enmod headers
  - sudo service apache2 restart
  - composer self-update
  - composer install --prefer-source --no-interaction --optimize-autoloader

before_script:
  - echo "xdebug.max_nesting_level = 500" >> ~/.phpenv/versions/$(phpenv version-name)/etc/php.ini

script:
  - bin/behat --format junit --out shippable/testresults/ features/test.feature
  
after_success:
  - echo "build success"

notifications:
  email: 
    varsha@shippable.com
  irc: "chat.freenode.net#test-irc"
    
archive: true
